# 出力層　誤差関数

## 出力層の役割
分類問題であれば、各クラスの確率を出力する。

訓練データ（入力に用いるデータと正解値）を準備する。

## 誤差関数
入力データからNNにデータを渡し、出力層で分類の確率を出す。
その後、訓練データの正解値と照合し、NNの結果が合っている/合っていないか確認する。

どのぐらい合っていたかを表現するのが、誤差関数。
授業では二乗誤差を使っている。
分類問題では、クロスエントロピー誤差を誤差関数に使うのが一般的。

![gif latex-77](https://user-images.githubusercontent.com/85814165/139612182-b4c718a8-033f-40d6-b6b0-1b2f9327df91.gif)

## 出力層の活性化関数
- 値の強弱
・中間層：しきい値の前後で信号の強弱を調整
・出力層：信号の大きさ（比率）はそのまま変換

- 確率出力
・分類問題の場合、出力層の出力は0~1の範囲に限定し、総和を1とする。

- 回帰
  - 活性化関数：恒等写像　f(u)=u
  - 誤差関数：二乗誤差、二乗平均誤差
- 二値分類
  - 活性化関数：シグモイド関数
  - 誤差関数：クロスエントロピー 
- 他クラス分類
  - 活性化関数：ソフトマックス関数
  - 誤差関数：クロスエントロピー 

## シグモイド関数

![gif latex-78](https://user-images.githubusercontent.com/85814165/139627326-bb17deed-15b9-4405-8e3a-0d106764eba8.gif)

![スクリーンショット 2021-11-01 14 50 06](https://user-images.githubusercontent.com/85814165/139627384-c08c00b9-07cc-411e-b67f-6e01c9f7e2c4.png)

## ソフトマックス関数

![gif latex-79](https://user-images.githubusercontent.com/85814165/139628201-e6064671-399c-4b12-ae9c-b275079a36fa.gif)

![スクリーンショット 2021-11-01 15 04 43](https://user-images.githubusercontent.com/85814165/139628623-3191d26b-a661-4a35-818c-43ba99fdffb6.png)


# 確認テスト
Q.なぜ引き算ではなく二乗するか述べよ
A.正解値から予測値の引き算だけを合計してしまうと各ラベルの誤差で正負どちらの値も計算してしまうので、誤差が把握できなくなってしまう。
2乗することでいずれのラベルの誤差が必ず正の値になり、その和をすることでどの程度誤差が生じているか把握できるようになる。

Q.下式の1/2はどういう意味を持つか述べよ
NNを学習する時に誤差逆伝播の計算をする際に、誤差関数の微分を用いる。その微分計算を簡便化するために、誤差関数に1/2の係数をかけているだけ。

Q.①〜③の数式に該当するソースコードを示し、１行ずつ処理の説明をせよ

A.
![スクリーンショット 2021-11-01 15 57 27](https://user-images.githubusercontent.com/85814165/139633478-80b86968-8b24-4ca4-aad9-176bec5a15c1.png)

n個ある出力層のi番目の出力f(i,u)を求める式で、入力信号ujの指数関数をすべての入力信号の指数関数の和で割ったもの。

Q.①〜②の数式に該当するソースコードを示し、１行ずつ処理の説明をせよ

A.
![スクリーンショット 2021-11-01 15 44 15](https://user-images.githubusercontent.com/85814165/139632199-dce2e220-208d-435f-8f0b-7a39df1ebe5d.png)

yとdをかけ合わせ、全て足し合わせる。yは0,1が並んだもので正解が1。dはNNが出力した正解だろうと予測した場所。
対数関数は0の時-∞になるので、0にならないように1e-7を入れている。


Q.該当するソースコードを探してみよう

Q.オンライン学習とはなにか２行でまとめよ

Q.この数式の意味を図に書いて説明せよ

Q.誤差逆伝播法では冬な再帰的処理を避けることができる。すでに行った計算結果を保持しているソースコードを抽出せよ

Q.２つの空欄に該当するソースコードを探せ

# 修了課題
