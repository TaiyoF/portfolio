# 勾配降下法
- 勾配降下法
- 確率的勾配降下法
- ミニバッチ勾配降下法
NNを学習させる手法のこと。
学習を通じて、重み・バイアスを最適化する。
誤差関数を最小にする重み・バイアスを見つけていく。

## 勾配降下法
全サンプルの平均誤差

![gif latex-81](https://user-images.githubusercontent.com/85814165/139636911-3b776db4-b84b-4ca3-b7c3-cfed8bfdeac5.gif)

ε＝学習率

学習率が大きいと、発散する可能性がある。
学習率が小さいと、収束するまでに時間がかかってしまう。また、底が複数ある場合は、１つ目の底で収束してしまう可能性がある。（極小値をとってしまう）
適切な学習率を設定しないといけない。

## アルゴリズム
- Momentum
- AdaGrad
- Adadelta
- Adam（最も使われる）

## エポック
学習する回数 epoch

## 確率的勾配降下法
ランダムに抽出したサンプルの誤差
メリット：計算コストの軽減、局所的な極小解に収束すりリスクの軽減、オンライン学習ができる
オンライン学習とは、学習データの追加ができる。リアルタイムにデータがくるものに対しても学習可能。
バッチ学習は一気に学習データを準備しないといけない。

![gif latex-82](https://user-images.githubusercontent.com/85814165/139641409-70244c9d-6a53-4364-8b30-6111eb1e55ab.gif)


## ミニバッチ勾配降下法
ランダムに分割したデータの集合（ミニバッチ）Dtに属するサンプルの平均誤差。
メモリを効率よく使える。

メリット：確率的勾配降下法のメリットを損なわず、計算機の計算資源（メモリ）を有効利用できる。
→CPUを利用したスレッド並列化やGPUを利用したSIMD並列化が可能。（SIMD：Single Instruction Multi Data）

![gif latex-83](https://user-images.githubusercontent.com/85814165/139663118-5b60b982-4535-4b4f-9096-711f0a1c2a5e.gif)

## 誤差勾配の計算

![gif latex-84](https://user-images.githubusercontent.com/85814165/139664895-d55d5ce9-6913-4b7a-a1b6-a92c0fe4b768.gif)

微分を使うことで重みの変化量を導くことができる。(わずかにその重みを増やした時)から(わずかにその重みを増やした時の差分)を引いてわずか(h)の２倍で割る。
ただし、計算量が莫大に増える。→誤差逆伝播法を使う。
 
![gif latex-85](https://user-images.githubusercontent.com/85814165/139665442-fef2424d-2321-44f9-9dd4-b94051306810.gif)

#  確認テスト

Q.該当するソースコードを探してみよう(勾配降下法）

![スクリーンショット 2021-11-01 16 43 35](https://user-images.githubusercontent.com/85814165/139638312-da81fea1-0afd-4219-98b8-b995f8de68c8.png)

Q.オンライン学習とはなにか２行でまとめよ

A.オンライン学習とは、都度学習データの追加ができ、パラメータ（重み・バイアス）の調整が可能。リアルタイムにデータがくるものに対しても学習可能。　
　バッチ学習とは、予め学習データを準備しないといけない。

Q.この数式の意味を図に書いて説明せよ（勾配降下法の式）

<img width="550" alt="スクリーンショット 2021-11-01 20 25 16" src="https://user-images.githubusercontent.com/85814165/139664344-a388132f-3bd7-4998-bb4c-e96d3ffb80fd.png">

１回目の学習ｔでWtを算出、２回目の学習t+1で間違った部分を修正したwt+1、３回目の学習t+2でさらに間違った部分を修正したのをwt+2とし、ｎ回までそれを繰り返していく。

# 実装
1_2_back_propagation.ipynbより

![スクリーンショット 2021-11-03 21 26 23](https://user-images.githubusercontent.com/85814165/140059733-ab13076b-2db5-4269-a6a8-4c84830859c9.png)
![スクリーンショット 2021-11-03 21 26 39](https://user-images.githubusercontent.com/85814165/140059757-8fe11a4c-12b7-4ae5-8eb9-2a6e8b2ab012.png)

